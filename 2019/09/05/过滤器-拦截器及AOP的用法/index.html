<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content>
  <meta name="author" content="Mr Wang">
  <!-- Open Graph Data -->
  <meta property="og:title" content="è¿‡æ»¤å™¨,æ‹¦æˆªå™¨åŠåˆ‡é¢çš„ç”¨æ³•">
  <meta property="og:description" content>
  <meta property="og:site_name" content="æ˜¥é£ä¸åŠä½ çš„ç¾ğŸ·">
  <meta property="og:type" content="article">
  <meta property="og:image" content="http://yoursite.com">
  
    <link rel="alternate" href="/atom.xml" title="æ˜¥é£ä¸åŠä½ çš„ç¾ğŸ·" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>æ˜¥é£ä¸åŠä½ çš„ç¾ğŸ·</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/css/style.light.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/img/default-banner-dark.jpg)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">è¿‡æ»¤å™¨,æ‹¦æˆªå™¨åŠåˆ‡é¢çš„ç”¨æ³•</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/<your-github-username>">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:<your-email-address>">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>

<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By Mr Wang</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2019-09-05</span>
            <span class="time">11:57:09</span>
          </span>
          
        </div>
        <!-- Tags -->
        
        <!-- Post Main Content -->
        <div class="post-content">
          <p><strong>è¿‡æ»¤å™¨</strong><br>  è¿‡æ»¤å™¨æ˜¯åœ¨Java webä¸­å°†ä¼ å…¥çš„requestå’Œresponseæå‰è¿‡æ»¤ä¸€äº›ä¿¡æ¯,æˆ–è€…æå‰è®¾ç½®ä¸€äº›å‚æ•°.ç„¶ååœ¨ä¼ å…¥servletè¿›è¡Œä¸šåŠ¡å¤„ç†.æ¯”å¦‚è¿‡æ»¤æ‰éæ³•URL(ä¸æ˜¯login.doçš„åœ°å€è¯·æ±‚,å¦‚æœç”¨æˆ·æ²¡ç™»é™†å°±éƒ½è¿‡æ»¤æ‰).ä¹Ÿå¯ä»¥æå‰è®¾ç½®å­—ç¬¦é›†,æˆ–è€…å»æ‰éæ³•å­—ç¬¦    </p>
<p><strong>æ‹¦æˆªå™¨</strong><br> æ‹¦æˆªå™¨æ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹,ä¾èµ–Springæ¡†æ¶,åŸºäºjavaåå°„æœºåˆ¶å®ç°çš„.æ‹¦æˆªå™¨å¯ä»¥åœ¨æ–¹æ³•è°ƒç”¨å‰åè¿›è¡Œä¸šåŠ¡å¤„ç†ã€‚æ‹¦æˆªå™¨åˆ°æ–¹æ³•çº§åˆ«.(æ¯”å¦‚æŸä¸ªcontrollerçš„æŸä¸ªmethodæ–¹æ³•)  </p>
<p><strong>AOP</strong><br>AOPæ˜¯Springæ¡†æ¶é¢å‘åˆ‡é¢çš„ç¼–ç¨‹æ€æƒ³,å…¶ç¼–ç¨‹æ€æƒ³æ˜¯å°†ä¸åŒä¸šåŠ¡ä½†åŠŸèƒ½ç›¸åŒçš„ä»£ç ä»ä¸šåŠ¡é€»è¾‘ä¸­æŠ½å–å‡ºæ¥,å°è£…æˆç‹¬ç«‹æ¨¡å—,è¿™ç§ç‹¬ç«‹æ¨¡å—ç§°ä¸ºåˆ‡é¢.åˆ‡é¢å…·ä½“åŠŸèƒ½æ–¹æ³•ç§°ä¸ºå…³æ³¨ç‚¹.(æ¯”å¦‚,æ¯ä¸ªä¸šåŠ¡éƒ½éœ€è¦ç™»å½•,å°±å¯ä»¥æŠŠç™»å½•è¿™ä¸ªä»£ç å°è£…æˆç‹¬ç«‹æ¨¡å—,è¿™ä¸ªå°±æ˜¯åˆ‡é¢).åœ¨ä¸šåŠ¡é€»è¾‘æ‰§è¡Œä¸­,AOPä¼šæŠŠåˆ†ç¦»å‡ºæ¥çš„åˆ‡é¢å’Œå…³æ³¨ç‚¹åŠ¨æ€åˆ‡å…¥åˆ°ä¸šåŠ¡æµç¨‹ä¸­,è¿™æ ·çš„å¥½å¤„æé«˜ä»£ç çš„å¤ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§.  </p>
<p><strong>è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨çš„åŒºåˆ«</strong><br>1.æ‹¦æˆªå™¨æ˜¯åŸºäºjavaåå°„æœºåˆ¶,è¿‡æ»¤å™¨æ˜¯å‡½æ•°å›è°ƒ<br>2.æ‹¦æˆªå™¨ä¸ä¾èµ–servletå®¹å™¨,è¿‡æ»¤å™¨ä¾èµ–servletå®¹å™¨<br>3.æ‹¦æˆªå™¨å¯ä»¥è¢«å¤šæ¬¡è°ƒç”¨,è¿‡æ»¤å™¨åªèƒ½åœ¨å®¹å™¨åˆå§‹åŒ–æ—¶è°ƒç”¨ä¸€æ¬¡<br>4.æ‹¦æˆªå™¨å¯ä»¥è·å–IOCå®¹å™¨çš„å„ç§bean,å¯ä»¥æ³¨å…¥service,è°ƒç”¨ä¸šåŠ¡,è¿‡æ»¤å™¨ä¸è¡Œ  </p>
<p><strong>å¦‚å›¾</strong><br><img src="/img/45.png" alt="å¦‚å›¾">  </p>
<p>è¿‡æ»¤å™¨æ‹¦æˆªå™¨è¿è¡Œå…ˆåæ­¥éª¤:<br><img src="/img/46.png" alt="å¦‚å›¾">  </p>
<p><strong>Spring bootè¿‡æ»¤å™¨çš„ä½¿ç”¨</strong><br>ä¸¤ç§æ–¹å¼ï¼š<br>1ã€ä½¿ç”¨spring bootæä¾›çš„FilterRegistrationBeanæ³¨å†ŒFilter<br>2ã€ä½¿ç”¨åŸç”Ÿservletæ³¨è§£å®šä¹‰Filter<br>æ–¹å¼ä¸€:<br>â‘ ã€å®šä¹‰è¿‡æ»¤å™¨:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">package com.example.demo.fifter;</span><br><span class="line"></span><br><span class="line">import javax.servlet.*;</span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @ClassName MyFifter</span><br><span class="line"> * @Description TODO</span><br><span class="line"> * @Author ç‹ç‚</span><br><span class="line"> * @Date 2019/9/5Â 16:23</span><br><span class="line"> * @ModifyDate 2019/9/5Â 16:23</span><br><span class="line"> * @Version 1.0</span><br><span class="line"> */</span><br><span class="line">public class MyFifter implements Filter &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void init(FilterConfig filterConfig) throws ServletException &#123;</span><br><span class="line">        System.out.println(&quot;å®¹å™¨å¯åŠ¨æ—¶,æ‰åˆå§‹åŒ–æ–¹æ³•======================&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;</span><br><span class="line">        long start = System.currentTimeMillis();</span><br><span class="line">        System.out.println(&quot;æ–¹æ³•å¼€å§‹ä¹‹å‰==============================&quot;);</span><br><span class="line">        filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">        System.out.println(&quot;æ–¹æ³•ç»“æŸ==================================&quot;);</span><br><span class="line">        System.out.println(&quot;æ–¹æ³•ç”¨æ—¶&quot; + (System.currentTimeMillis() - start));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void destroy() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>â‘¡ã€é…ç½®è¿‡æ»¤å™¨:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">package com.example.demo.config;</span><br><span class="line">import com.example.demo.fifter.MyFifter;</span><br><span class="line">import org.springframework.boot.web.servlet.FilterRegistrationBean;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @ClassName FilterConfig</span><br><span class="line"> * @Description TODO</span><br><span class="line"> * @Author ç‹ç‚</span><br><span class="line"> * @Date 2019/9/5Â 16:29</span><br><span class="line"> * @ModifyDate 2019/9/5Â 16:29</span><br><span class="line"> * @Version 1.0</span><br><span class="line"> */</span><br><span class="line">@Configuration</span><br><span class="line">public class FilterConfig &#123;</span><br><span class="line">    @Bean</span><br><span class="line">    public FilterRegistrationBean registFilter() &#123;</span><br><span class="line">        FilterRegistrationBean registration = new FilterRegistrationBean();</span><br><span class="line">        registration.setFilter(new MyFifter());</span><br><span class="line">        registration.addUrlPatterns(&quot;/*&quot;);</span><br><span class="line">        registration.setName(&quot;MyFilter&quot;);</span><br><span class="line">        //è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº</span><br><span class="line">        registration.setOrder(1);</span><br><span class="line">        return registration;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–å†™controller</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">package com.example.demo.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line">import org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/demo&quot;)</span><br><span class="line">public class UserInfoController &#123;</span><br><span class="line">    @RequestMapping(&quot;/hello&quot;)</span><br><span class="line">    public String hello() &#123;</span><br><span class="line">        System.out.println(&quot;helloæ–¹æ³•å¼€å§‹================================&quot;);</span><br><span class="line">        try &#123;</span><br><span class="line">            Thread.sleep(3000);</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        return &quot;hello&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“æœ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æ‰æ–¹æ³•ä¹‹å‰================</span><br><span class="line">helloæ–¹æ³•å¼€å§‹================================</span><br><span class="line">æ–¹æ³•ç»“æŸ==================================</span><br><span class="line">æ–¹æ³•èŠ±è´¹æ—¶é—´===========3041</span><br></pre></td></tr></table></figure>

<p>æ–¹å¼äºŒ:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">package com.example.demo.fifter;</span><br><span class="line"></span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">import javax.servlet.*;</span><br><span class="line">import javax.servlet.annotation.WebFilter;</span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @ClassName MyFilter2</span><br><span class="line"> * @Description TODO</span><br><span class="line"> * @Author ç‹ç‚</span><br><span class="line"> * @Date 2019/9/6Â 10:30</span><br><span class="line"> * @ModifyDate 2019/9/6Â 10:30</span><br><span class="line"> * @Version 1.0</span><br><span class="line"> */</span><br><span class="line">@Component</span><br><span class="line">@WebFilter(filterName = &quot;MyFilter2&quot;, urlPatterns = &quot;/*&quot;)</span><br><span class="line">public class MyFilter2 implements Filter &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void init(FilterConfig filterConfig) throws ServletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;</span><br><span class="line">        long start = System.currentTimeMillis();</span><br><span class="line">        System.out.println(&quot;æ–¹æ³•å¼€å§‹ä¹‹å‰==============================&quot;);</span><br><span class="line">        filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">        System.out.println(&quot;æ–¹æ³•ç»“æŸ==================================&quot;);</span><br><span class="line">        System.out.println(&quot;æ–¹æ³•ç”¨æ—¶&quot; + (System.currentTimeMillis() - start));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void destroy() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“æœ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æ‰æ–¹æ³•ä¹‹å‰================</span><br><span class="line">helloæ–¹æ³•å¼€å§‹================================</span><br><span class="line">æ–¹æ³•ç»“æŸ==================================</span><br><span class="line">æ–¹æ³•èŠ±è´¹æ—¶é—´===========3041</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœ‰å¤šä¸ªè¿‡æ»¤å™¨,ç¬¬äºŒç§ä½¿ç”¨å…ˆåé¡ºåº,æ‰€ä»¥ä¸€èˆ¬ç”¨ç¬¬ä¸€ç§é…ç½®  </p>
<hr>
<p><strong>Spring bootæ‹¦æˆªå™¨çš„ä½¿ç”¨</strong><br>â‘ ã€å®šä¹‰æ‹¦æˆªå™¨ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">package com.example.demo.interceptor;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line">import org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @ClassName MyInterceptor</span><br><span class="line"> * @Description TODO</span><br><span class="line"> * @Author ç‹ç‚</span><br><span class="line"> * @Date 2019/9/5Â 16:36</span><br><span class="line"> * @ModifyDate 2019/9/5Â 16:36</span><br><span class="line"> * @Version 1.0</span><br><span class="line"> */</span><br><span class="line">public class MyInterceptor implements HandlerInterceptor &#123;</span><br><span class="line">    long start=System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * æ‹¦æˆªä¹‹å‰è°ƒç”¨ï¼ˆè¿›å…¥Controllerä¹‹å‰ï¼‰</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) &#123;</span><br><span class="line">        System.out.println(&quot;æ‰æ–¹æ³•ä¹‹å‰================&quot;);</span><br><span class="line">        start=System.currentTimeMillis();</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * è°ƒç”¨æ–¹æ³•ä¹‹åï¼Œè§†å›¾æ¸²æŸ“ä¹‹å‰</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) &#123;</span><br><span class="line">        System.out.println(&quot;æ–¹æ³•ç»“æŸ==================================&quot;);</span><br><span class="line">        System.out.println(&quot;æ–¹æ³•èŠ±è´¹æ—¶é—´===========&quot;+(System.currentTimeMillis()-start));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * å®Œæˆæ‹¦æˆªä¹‹åï¼Œç”¨äºæ¸…ç†èµ„æº</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) &#123;</span><br><span class="line">        System.out.println(&quot;afterCompletion MyInterceptor&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>â‘¡ã€é…ç½®æ‹¦æˆªå™¨ï¼š</p>
<pre><code>package com.example.demo.config;


import com.example.demo.interceptor.MyInterceptor;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;


/**
 * @ClassName InterceptorConfig
 * @Description TODO
 * @Author ç‹ç‚
 * @Date 2019/9/5 16:46
 * @ModifyDate 2019/9/5 16:46
 * @Version 1.0
 */
@Configuration
public class InterceptorConfig implements WebMvcConfigurer {

    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(new MyInterceptor()).addPathPatterns(&quot;/**&quot;);
    }
}

</code></pre><p> ç¼–å†™controller</p>
<pre><code>package com.example.demo.controller;


import org.springframework.web.bind.annotation.RequestMapping;

import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping(&quot;/demo&quot;)
public class UserInfoController {
    @RequestMapping(&quot;/hello&quot;)
    public String hello() {
        System.out.println(&quot;helloæ–¹æ³•å¼€å§‹================================&quot;);
        try {
            Thread.sleep(3000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        return &quot;hello&quot;;
    }
}

</code></pre><p>ç»“æœ</p>
<pre><code>æ‰æ–¹æ³•ä¹‹å‰================
helloæ–¹æ³•å¼€å§‹================================
æ–¹æ³•ç»“æŸ==================================
æ–¹æ³•èŠ±è´¹æ—¶é—´===========3041
afterCompletion MyInterceptor</code></pre><hr>
<p><strong>Spring boot AOPçš„ä½¿ç”¨</strong></p>
<p>AOPçš„æ¦‚å¿µï¼š<br><strong>åˆ‡é¢ï¼ˆAspectï¼‰</strong><br>å…¶å®å°±æ˜¯å…±æœ‰åŠŸèƒ½çš„å®ç°ã€‚å¦‚æ—¥å¿—åˆ‡é¢ã€æƒé™åˆ‡é¢ã€äº‹åŠ¡åˆ‡é¢ç­‰ã€‚åœ¨å®é™…åº”ç”¨ä¸­é€šå¸¸æ˜¯ä¸€ä¸ªå­˜æ”¾å…±æœ‰åŠŸèƒ½å®ç°çš„æ™®é€šJavaç±»ï¼Œä¹‹æ‰€ä»¥èƒ½è¢«AOPå®¹å™¨è¯†åˆ«æˆåˆ‡é¢ï¼Œæ˜¯åœ¨é…ç½®ä¸­æŒ‡å®šçš„ã€‚</p>
<p><strong>å¢å¼ºï¼ˆAdviceï¼‰</strong><br>æ˜¯åˆ‡é¢çš„å…·ä½“å®ç°ã€‚ä»¥ç›®æ ‡æ–¹æ³•ä¸ºå‚ç…§ç‚¹ï¼Œæ ¹æ®æ”¾ç½®çš„åœ°æ–¹ä¸åŒï¼Œå¯åˆ†ä¸ºå‰ç½®é€šçŸ¥ï¼ˆBeforeï¼‰ã€åç½®é€šçŸ¥ï¼ˆAfterReturningï¼‰ã€å¼‚å¸¸é€šçŸ¥ï¼ˆAfterThrowingï¼‰ã€æœ€ç»ˆé€šçŸ¥ï¼ˆAfterï¼‰ä¸ç¯ç»•é€šçŸ¥ï¼ˆAroundï¼‰5ç§ã€‚åœ¨å®é™…åº”ç”¨ä¸­é€šå¸¸æ˜¯åˆ‡é¢ç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå…·ä½“å±äºå“ªç±»é€šçŸ¥ï¼ŒåŒæ ·æ˜¯åœ¨é…ç½®ä¸­æŒ‡å®šçš„ã€‚</p>
<p><strong>è¿æ¥ç‚¹ï¼ˆJoinpointï¼‰</strong><br>å°±æ˜¯ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­èƒ½å¤Ÿæ’å…¥åˆ‡é¢çš„åœ°ç‚¹ã€‚ä¾‹å¦‚ï¼Œæ–¹æ³•è°ƒç”¨ã€å¼‚å¸¸æŠ›å‡ºæˆ–å­—æ®µä¿®æ”¹ç­‰ï¼Œä½†springåªæ”¯æŒæ–¹æ³•çº§çš„è¿æ¥ç‚¹ã€‚</p>
<p><strong>åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰</strong><br>ç”¨äºå®šä¹‰é€šçŸ¥åº”è¯¥åˆ‡å…¥åˆ°å“ªäº›è¿æ¥ç‚¹ä¸Šã€‚ä¸åŒçš„é€šçŸ¥é€šå¸¸éœ€è¦åˆ‡å…¥åˆ°ä¸åŒçš„è¿æ¥ç‚¹ä¸Šï¼Œè¿™ç§ç²¾å‡†çš„åŒ¹é…æ˜¯ç”±åˆ‡å…¥ç‚¹çš„æ­£åˆ™è¡¨è¾¾å¼æ¥å®šä¹‰çš„ã€‚</p>
<p><strong>ç›®æ ‡å¯¹è±¡ï¼ˆTargetï¼‰</strong><br>å°±æ˜¯é‚£äº›å³å°†åˆ‡å…¥åˆ‡é¢çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯é‚£äº›è¢«é€šçŸ¥çš„å¯¹è±¡ã€‚è¿™äº›å¯¹è±¡ä¸­å·²ç»åªå‰©ä¸‹å¹²å¹²å‡€å‡€çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»£ç äº†ï¼Œæ‰€æœ‰çš„å…±æœ‰åŠŸèƒ½ä»£ç ç­‰å¾…AOPå®¹å™¨çš„åˆ‡å…¥ã€‚</p>
<p><strong>ä»£ç†å¯¹è±¡ï¼ˆProxyï¼‰</strong><br>å°†é€šçŸ¥åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡ä¹‹åè¢«åŠ¨æ€åˆ›å»ºçš„å¯¹è±¡ã€‚å¯ä»¥ç®€å•åœ°ç†è§£ä¸ºï¼Œä»£ç†å¯¹è±¡çš„åŠŸèƒ½ç­‰äºç›®æ ‡å¯¹è±¡çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘åŠŸèƒ½åŠ ä¸Šå…±æœ‰åŠŸèƒ½ã€‚ä»£ç†å¯¹è±¡å¯¹äºä½¿ç”¨è€…è€Œè¨€æ˜¯é€æ˜çš„ï¼Œæ˜¯ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­çš„äº§ç‰©ã€‚</p>
<p><strong>ç»‡å…¥ï¼ˆWeavingï¼‰</strong><br>å°†åˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡ä»è€Œåˆ›å»ºä¸€ä¸ªæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥å‘ç”Ÿåœ¨ç¼–è¯‘æœŸã€ç±»è£…è½½æœŸåŠè¿è¡ŒæœŸï¼Œå½“ç„¶ä¸åŒçš„å‘ç”Ÿç‚¹æœ‰ç€ä¸åŒçš„å‰ææ¡ä»¶ã€‚è­¬å¦‚å‘ç”Ÿåœ¨ç¼–è¯‘æœŸçš„è¯ï¼Œå°±è¦æ±‚æœ‰ä¸€ä¸ªæ”¯æŒè¿™ç§AOPå®ç°çš„ç‰¹æ®Šç¼–è¯‘å™¨ï¼›å‘ç”Ÿåœ¨ç±»è£…è½½æœŸï¼Œå°±è¦æ±‚æœ‰ä¸€ä¸ªæ”¯æŒAOPå®ç°çš„ç‰¹æ®Šç±»è£…è½½å™¨ï¼›åªæœ‰å‘ç”Ÿåœ¨è¿è¡ŒæœŸï¼Œåˆ™å¯ç›´æ¥é€šè¿‡Javaè¯­è¨€çš„åå°„æœºåˆ¶ä¸åŠ¨æ€ä»£ç†æœºåˆ¶æ¥åŠ¨æ€å®ç°ã€‚è¿˜æœ‰å¼•å…¥ï¼ˆIntroductionï¼‰ï¼Œç”¨ä»¥åŒºåˆ†ç±»å’Œæ–¹æ³•çš„æ‹¦æˆªã€‚</p>
<p>Springåˆ‡é¢å®šä¹‰äº†5ç§ç±»å‹é€šçŸ¥ï¼š</p>
<p>1ï¼‰å‰ç½®é€šçŸ¥(Before)ï¼šåœ¨ç›®æ ‡æ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰è°ƒç”¨é€šçŸ¥åŠŸèƒ½ã€‚</p>
<p>2ï¼‰åç½®é€šçŸ¥(After)ï¼šåœ¨ç›®æ ‡æ–¹æ³•å®Œæˆä¹‹åè°ƒç”¨é€šçŸ¥ï¼Œä¸ä¼šå…³å¿ƒæ–¹æ³•çš„è¾“å‡ºæ˜¯ä»€ä¹ˆã€‚</p>
<p>3ï¼‰è¿”å›é€šçŸ¥(After-returning)ï¼š åœ¨ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œä¹‹åè°ƒç”¨é€šçŸ¥ã€‚</p>
<p>4ï¼‰å¼‚å¸¸é€šçŸ¥(After-throwing)ï¼šåœ¨ç›®æ ‡æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åè°ƒç”¨é€šçŸ¥ã€‚</p>
<p>5ï¼‰ç¯ç»•é€šçŸ¥(Around)ï¼šé€šçŸ¥åŒ…è£¹äº†è¢«é€šçŸ¥çš„æ–¹æ³•ï¼Œåœ¨è¢«é€šçŸ¥çš„æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œä¹‹åæ‰§è¡Œè‡ªå®šä¹‰çš„è¡Œä¸ºã€‚</p>
<hr>
<pre><code>package com.example.demo.aop;

import org.aspectj.lang.JoinPoint;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.Signature;
import org.aspectj.lang.annotation.*;
import org.aspectj.lang.reflect.MethodSignature;
import org.springframework.stereotype.Component;
import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;

import javax.servlet.http.HttpServletRequest;
import java.util.Arrays;

/**
 * @ClassName WebControllerAop
 * @Description TODO
 * @Author ç‹ç‚
 * @Date 2019/9/6 11:25
 * @ModifyDate 2019/9/6 11:25
 * @Version 1.0
 */
@Aspect
@Component
public class WebControllerAop {

    @Pointcut(&quot;execution(public * com.example.demo.controller.*.*(..))&quot;)
    public void webLog() {

    }

    /**
     * å‰ç½®é€šçŸ¥ï¼Œæ–¹æ³•è°ƒç”¨å‰è¢«è°ƒç”¨
     *
     * @param joinPoint
     */
    @Before(&quot;webLog()&quot;)
    public void doBefore(JoinPoint joinPoint) {
        System.out.println(&quot;æˆ‘æ˜¯å‰ç½®é€šçŸ¥!!!&quot;);
        //è·å–ç›®æ ‡æ–¹æ³•çš„å‚æ•°ä¿¡æ¯
        Object[] obj = joinPoint.getArgs();
        Signature signature = joinPoint.getSignature();
        //ä»£ç†çš„æ˜¯å“ªä¸€ä¸ªæ–¹æ³•
        System.out.println(&quot;æ–¹æ³•ï¼š&quot; + signature.getName());
        //AOPä»£ç†ç±»çš„åå­—
        System.out.println(&quot;æ–¹æ³•æ‰€åœ¨åŒ…:&quot; + signature.getDeclaringTypeName());
        //AOPä»£ç†ç±»çš„ç±»ï¼ˆclassï¼‰ä¿¡æ¯
        signature.getDeclaringType();
        MethodSignature methodSignature = (MethodSignature) signature;
        String[] strings = methodSignature.getParameterNames();
        System.out.println(&quot;å‚æ•°åï¼š&quot; + Arrays.toString(strings));
        System.out.println(&quot;å‚æ•°å€¼ARGS : &quot; + Arrays.toString(joinPoint.getArgs()));
        // æ¥æ”¶åˆ°è¯·æ±‚ï¼Œè®°å½•è¯·æ±‚å†…å®¹
        ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
        HttpServletRequest req = attributes.getRequest();
        // è®°å½•ä¸‹è¯·æ±‚å†…å®¹
        System.out.println(&quot;è¯·æ±‚URL : &quot; + req.getRequestURL().toString());
        System.out.println(&quot;HTTP_METHOD : &quot; + req.getMethod());
        System.out.println(&quot;IP : &quot; + req.getRemoteAddr());
        System.out.println(&quot;CLASS_METHOD : &quot; + joinPoint.getSignature().getDeclaringTypeName() + &quot;.&quot; + joinPoint.getSignature().getName());

    }

    /**
     * å¤„ç†å®Œè¯·æ±‚è¿”å›å†…å®¹
     *
     * @param ret
     * @throws Throwable
     */
    @AfterReturning(returning = &quot;ret&quot;, pointcut = &quot;webLog()&quot;)
    public void doAfterReturning(Object ret) throws Throwable {
        // å¤„ç†å®Œè¯·æ±‚ï¼Œè¿”å›å†…å®¹
        System.out.println(&quot;æ–¹æ³•çš„è¿”å›å€¼ : &quot; + ret);
    }

    /**
     * åç½®å¼‚å¸¸é€šçŸ¥
     *
     * @param jp
     */
    @AfterThrowing(&quot;webLog()&quot;)
    public void throwss(JoinPoint jp) {
        System.out.println(&quot;æ–¹æ³•å¼‚å¸¸æ—¶æ‰§è¡Œ.....&quot;);
    }

    /**
     * åç½®æœ€ç»ˆé€šçŸ¥,finalå¢å¼ºï¼Œä¸ç®¡æ˜¯æŠ›å‡ºå¼‚å¸¸æˆ–è€…æ­£å¸¸é€€å‡ºéƒ½ä¼šæ‰§è¡Œ
     *
     * @param jp
     */
    @After(&quot;webLog()&quot;)
    public void after(JoinPoint jp) {
        System.out.println(&quot;æˆ‘æ˜¯åç½®é€šçŸ¥!!!&quot;);
    }

    /**
     * ç¯ç»•é€šçŸ¥,ç¯ç»•å¢å¼ºï¼Œç›¸å½“äºMethodInterceptor
     *
     * @param pjp
     * @return
     */
    @Around(&quot;webLog()&quot;)
    public Object arround(ProceedingJoinPoint pjp) {
        try {
            System.out.println(&quot;è°ƒç”¨æ–¹æ³•å‰====================&quot;);
            Object o = pjp.proceed();
            System.out.println(&quot;è°ƒç”¨æ–¹æ³•å====================&quot;);
            return o;
        } catch (Throwable e) {
            e.printStackTrace();
            return null;
        }
    }


}

</code></pre>
        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        <p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

